<!-- Angular Register Template -->
<div class="floating-shapes">
  <div class="shape"></div>
  <div class="shape"></div>
  <div class="shape"></div>
</div>

<div class="auth-container">
  <!-- Register Form -->
  <div class="card auth-card">
    <div class="auth-header">
      <div class="auth-icon">
        <i class="fas fa-user-plus"></i>
      </div>
      <h3>Rejoignez-nous !</h3>
      <p>Créez votre compte professionnel</p>
    </div>
    
    <div class="auth-form">
      <!-- Global Error Message -->
      <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        <span>{{ errorMessage }}</span>
      </div>
      
      <form (ngSubmit)="onSubmit()" #registerForm="ngForm">
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="firstName" class="form-label">
                <i class="fas fa-user"></i>
                Prénom
              </label>
              <input 
                type="text" 
                id="firstName"
                class="form-control"
                [class.is-invalid]="hasFieldError('firstName')"
                name="firstName"
                [(ngModel)]="registerData.firstName"
                required
                placeholder="Votre prénom"
                [disabled]="isLoading"
              >
              <div *ngIf="hasFieldError('firstName')" class="invalid-feedback">
                <i class="fas fa-exclamation-circle"></i>
                {{ getFieldError('firstName') }}
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="form-group">
              <label for="lastName" class="form-label">
                <i class="fas fa-user"></i>
                Nom
              </label>
              <input 
                type="text" 
                id="lastName"
                class="form-control"
                [class.is-invalid]="hasFieldError('lastName')"
                name="lastName"
                [(ngModel)]="registerData.lastName"
                required
                placeholder="Votre nom"
                [disabled]="isLoading"
              >
              <div *ngIf="hasFieldError('lastName')" class="invalid-feedback">
                <i class="fas fa-exclamation-circle"></i>
                {{ getFieldError('lastName') }}
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="registerEmail" class="form-label">
            <i class="fas fa-envelope"></i>
            Email
          </label>
          <input 
            type="email" 
            id="registerEmail"
            class="form-control"
            [class.is-invalid]="hasFieldError('email')"
            name="email"
            [(ngModel)]="registerData.email"
            required
            placeholder="votre.email@exemple.com"
            [disabled]="isLoading"
          >
          <div *ngIf="hasFieldError('email')" class="invalid-feedback">
            <i class="fas fa-exclamation-circle"></i>
            {{ getFieldError('email') }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="phone" class="form-label">
            <i class="fas fa-phone"></i>
            Téléphone
          </label>
          <input 
            type="tel" 
            id="phone"
            class="form-control"
            [class.is-invalid]="hasFieldError('phone')"
            name="phone"
            [(ngModel)]="registerData.phone"
            required
            placeholder="+216 XX XXX XXX"
            [disabled]="isLoading"
          >
          <div *ngIf="hasFieldError('phone')" class="invalid-feedback">
            <i class="fas fa-exclamation-circle"></i>
            {{ getFieldError('phone') }}
          </div>
        </div>
        
        <div class="form-group">
          <label for="userType" class="form-label">
            <i class="fas fa-briefcase"></i>
            Type de compte
          </label>
          <select 
            id="userType"
            class="form-select"
            name="userType"
            [(ngModel)]="registerData.userType"
            required
            [disabled]="isLoading"
          >
            <option value="job_seeker">Chercheur d'emploi</option>
            <option value="company">Entreprise</option>
          </select>
        </div>
        
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="registerPassword" class="form-label">
                <i class="fas fa-lock"></i>
                Mot de passe
              </label>
              <input 
                type="password" 
                id="registerPassword"
                class="form-control"
                [class.is-invalid]="hasFieldError('password')"
                name="password"
                [(ngModel)]="registerData.password"
                required
                minlength="6"
                placeholder="••••••••"
                [disabled]="isLoading"
              >
              <div *ngIf="hasFieldError('password')" class="invalid-feedback">
                <i class="fas fa-exclamation-circle"></i>
                {{ getFieldError('password') }}
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="form-group">
              <label for="confirmPassword" class="form-label">
                <i class="fas fa-lock"></i>
                Confirmer le mot de passe
              </label>
              <input 
                type="password" 
                id="confirmPassword"
                class="form-control"
                [class.is-invalid]="hasFieldError('confirmPassword')"
                name="confirmPassword"
                [(ngModel)]="confirmPassword"
                (input)="onConfirmPasswordChange()"
                required
                placeholder="••••••••"
                [disabled]="isLoading"
              >
              <div *ngIf="hasFieldError('confirmPassword')" class="invalid-feedback">
                <i class="fas fa-exclamation-circle"></i>
                {{ getFieldError('confirmPassword') }}
              </div>
            </div>
          </div>
        </div>
        
        <button 
          type="submit" 
          class="btn btn-primary" 
          [disabled]="isLoading || !registerForm.valid"
        >
          <span 
            *ngIf="isLoading" 
            class="spinner-border spinner-border-sm me-2" 
            role="status"
          ></span>
          <i 
            *ngIf="!isLoading" 
            class="fas fa-user-plus me-2"
          ></i>
          <span>{{ isLoading ? 'Inscription...' : 'S\'inscrire' }}</span>
        </button>
      </form>
      
      <div class="auth-link">
        <p>Déjà inscrit ?</p>
        <a 
          href="#" 
          (click)="goToLogin()"
          [class.disabled]="isLoading"
        >
          <i class="fas fa-sign-in-alt me-2"></i>
          Se connecter
        </a>
      </div>
    </div>
  </div>
</div>